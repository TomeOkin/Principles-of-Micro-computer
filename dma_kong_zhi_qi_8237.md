# DMA控制器8237

1.编程结构
 （1）8237包含4个独立的DMA通道，每个通道包含16位的地址寄存器和16位的字节计数器，还包含一个8位的模式寄存器。4个通道共用控制寄存器和状态寄存器。
 （2）DB7~DB0作为分时复用的三态数据/地址线。
     A7~A4作为三态输出地址线。
     A3~A0作为双向三态地址线。
 （3）基本字节计数器存放的初值比实际传输的字节数少1。8237A芯片在DMA传输时，每传输一个字节，当前字节计数器的值自动减1，当由0减到FFFFH时，产生计算结束信号/EOP。
 
2.信号
 （1）8086/8088在最小方式下有关总线请求的信号引线是HOLD和HLDA。
 （2）DREQ是DMA请求信号， DACK是DMA应答信号。
 （3）8237A工作在主模块时，DB0~DB7输出的是地址寄存器中的高8位地址信号。
 （4）/IOR和/IOW为双向信号。

3.模式寄存器：
 （1）工作模式：单字节传输模式、块传输模式、请求传输模式、级联传输模式。
   多个8237A可以进行级联，构成主从式的DMA系统。
   （题目：8237A有4个DMA通道，可以由5片8237A构成两级DMA系统，共16个DMA通道。）
 （2）传输类型：校验传输、写传输、读传输。
   DMA写操作把数据从I/O接口传到内存。DMA读操作把数据从存储器传到I/O接口。
 （3）优先级管理：一种是固定优先级，此时通道0优先级最高；另一种为循环优先级方式。
 8237A在进行内存到内存的传输时，固定使用通道0和通道1。
 
5.在进入DMA工作方式之前，DMA控制器被当作CPU总线上的一个I/O接口。
 在DMA方式下，外设数据输入到内存的路径是外设→DMAC→内存。此时CPU与总线相互成隔离状态。
 DMA控制器可以像CPU一样得到总线控制权，DMA控制器中和某个接口的联系的部分称为通道。

6.为了使DMA控制器正常工作，要对DMA控制器进行初始化，初始化过程包含两方面：
 将数据传送缓冲区的起始地址和结束地址送到地址寄存器和将传输的字节数、字数、或双字数送到计数器。